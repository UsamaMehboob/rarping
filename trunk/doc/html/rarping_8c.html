<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>RARPing: rarping/rarping.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>rarping/rarping.c File Reference</h1>Rarping - send RARP REQUEST to a neighbour host. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="rarping_8h.html">rarping.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for rarping.c:</div>
<div class="dynsection">
<p><center><img src="rarping_8c__incl.png" border="0" usemap="#rarping/rarping.c_map" alt=""></center>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#4f24c79e4a47dd1904b8857ca16264a4">MAC_FIELD</a>(a)&nbsp;&nbsp;&nbsp;(&amp;(pstr_packet-&gt;str_packet.tuc_targetHwAddr[(a)]))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#3672fcf015b00197c21d3807411f7fca">OPERATION</a>(o)&nbsp;&nbsp;&nbsp;( ( o == htons(RARP_OPCODE_REPLY) ) ? &quot;Reply&quot; : &quot;Request&quot; )</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#0dc24ff376670e9bec90dc60d7dfdc78">__MAC</a>(i)&nbsp;&nbsp;&nbsp;(pstr_reply-&gt;tuc_senderHwAddr[(i)])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#370fdec85b226dbc8e3c347051e0a48a">MAC</a>(i)&nbsp;&nbsp;&nbsp;pstr_reply-&gt;tuc_senderHwAddr[(i)]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#40075e1591659ba8ec8a37a9fcc4d8b3">_MAC</a>(i)&nbsp;&nbsp;&nbsp;pstr_reply-&gt;str_packet.tuc_targetHwAddr[(i)]</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#c1fc16855ffe58bf476aad4da287655a">main</a> (int i_argc, char **ppch_argv)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#e397cceb6eb270526ed25111b8e4bff3">argumentManagement</a> (long l_argc, char **ppch_argv, <a class="el" href="structopt__t.html">opt_t</a> *pstr_argsDest)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parse given arguments and fill an opt structure.  <a href="#e397cceb6eb270526ed25111b8e4bff3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#1432cdc2d9d5c8ada6ea3bb523f07f73">initOptionsDefault</a> (<a class="el" href="structopt__t.html">opt_t</a> *pstr_args)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set options to their default values  <a href="#1432cdc2d9d5c8ada6ea3bb523f07f73"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#e8605e2b78cd4a81b6c6b5c30cb7366a">usage</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Usage() prints out some help to craft a correct command line.  <a href="#e8605e2b78cd4a81b6c6b5c30cb7366a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#975c3819cf5b8555b0b73653625bc83c">parseTimeout</a> (struct timeval *pstr_timeout, char *pch_arg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set the send/recv timeout from command line to integers  <a href="#975c3819cf5b8555b0b73653625bc83c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#2497a004acee842423e413bd0f7c52a4">signalHandler</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">turn on the signal handler  <a href="#2497a004acee842423e413bd0f7c52a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#06ebd348792c0bc8027a46188dd634b5">performRequests</a> (const <a class="el" href="structopt__t.html">opt_t</a> *pstr_argsDest)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">perform RARP requests the way defined by user  <a href="#06ebd348792c0bc8027a46188dd634b5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#7ed00cf5907b4a33a63d30fcfec8254a">craftPacket</a> (<a class="el" href="structetherPacket__t.html">etherPacket_t</a> *pstr_packet, const <a class="el" href="structopt__t.html">opt_t</a> *pstr_destArgs, struct sockaddr_ll *pstr_device, long l_socket)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">find out and packs the datas we'll send  <a href="#7ed00cf5907b4a33a63d30fcfec8254a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#13c258f47f42f6e9a08dae19c34bce70">getLowLevelInfos</a> (struct sockaddr_ll *pstr_device, char *pch_ifaceName, long l_socket)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fills a sockaddr_ll struct whith hardware address and interface index of a selected device  <a href="#13c258f47f42f6e9a08dae19c34bce70"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#9a6902ad34267ecbc0b310fd3ccaa0cb">getLocalHardwareAddress</a> (long l_socket, char *pch_ifaceName, unsigned char *puc_mac)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fill hw_addr field of pstr_device with local MAC address  <a href="#9a6902ad34267ecbc0b310fd3ccaa0cb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#b184cb462e59b63bec4d7a59f05afea6">getIfaceIndex</a> (char *pch_ifName, long l_socket)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get Index of used network interface  <a href="#b184cb462e59b63bec4d7a59f05afea6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#4d844224c84eb2a75608f8840a5d72be">sendProbe</a> (long l_socket, <a class="el" href="structetherPacket__t.html">etherPacket_t</a> *pstr_packet, struct sockaddr_ll *pstr_device)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send RARP requests into the wild  <a href="#4d844224c84eb2a75608f8840a5d72be"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#ed621b2e2a3ad104bf667e26e80c35ca">getAnswer</a> (long l_socket, struct sockaddr_ll *pstr_device, const struct timeval str_sendingMoment)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">wait for an answer and, if receive any, parse it  <a href="#ed621b2e2a3ad104bf667e26e80c35ca"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#22be8ae77bc49dfa0a403b60e5186e2b">printOutReply</a> (<a class="el" href="structetherPacket__t.html">etherPacket_t</a> *pstr_reply, const struct timeval str_delay)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">check if received packet seems correct (or not) it and print its main informations  <a href="#22be8ae77bc49dfa0a403b60e5186e2b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#8ae63b7cf808d9190afe4bb3a8c2968b">parse</a> (<a class="el" href="structetherPacket__t.html">etherPacket_t</a> *pstr_reply, char tch_replySrcIp[], char tch_replySrcHwAddr[], char tch_replyHwAddr[], char tch_replyAddrIp[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse an reply packet and fill strings to print results out in a clean way  <a href="#8ae63b7cf808d9190afe4bb3a8c2968b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#984e5dd95edfe9b2c7f7811d07e4a7cc">footer</a> (unsigned long ul_sentPackets, unsigned long ul_receivedPackets)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">print out a summary of what happened  <a href="#984e5dd95edfe9b2c7f7811d07e4a7cc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#bf75ee27a5591a9c04cb8720abbf4518">openRawSocket</a> (struct timeval str_timeout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">open a raw socket and set timeout on sending and reception  <a href="#bf75ee27a5591a9c04cb8720abbf4518"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#56282d3e5a61eb963960b9e342c9209b">loop</a> (const <a class="el" href="structopt__t.html">opt_t</a> *pstr_argsDest, <a class="el" href="structetherPacket__t.html">etherPacket_t</a> *pstr_packet, struct sockaddr_ll *pstr_device, long l_socket)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sending loop : send packets as many times as wanted  <a href="#56282d3e5a61eb963960b9e342c9209b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#728f873a92175b64fb21ff9e4d497af4">setTargetIpAddress</a> (unsigned char *puc_targetIpAddress, const <a class="el" href="structopt__t.html">opt_t</a> *pstr_argsDest)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fills target protocol address in sent packets according to user choices (option -a)  <a href="#728f873a92175b64fb21ff9e4d497af4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">signed char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#3023edfca60313cf518681d105a5ba23">setSenderIpAddress</a> (unsigned char *puc_senderIpAddress, const <a class="el" href="structopt__t.html">opt_t</a> *pstr_argsDest, long l_socket)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set source IP address in packets to wanted values  <a href="#3023edfca60313cf518681d105a5ba23"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct timeval&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#8ddba88678a5ae107d94fbe38926221d">timeDiff</a> (const struct timeval str_beginning, const struct timeval str_termination)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return elapsed time between two given moments  <a href="#8ddba88678a5ae107d94fbe38926221d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#9f9e5763d159bb3d641265d0030a65c2">printTime_ms</a> (const struct timeval str_time)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">print out elapsed time from a timeval structure to usual format in milliseconds  <a href="#9f9e5763d159bb3d641265d0030a65c2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#abfe4c4e5d4579ed37318039e6b20678">rarpingOnExit</a> (int sig)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">perform a clean exit, calling statistics function and closing the socket  <a href="#abfe4c4e5d4579ed37318039e6b20678"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#ab6d37ae989eb0b6cd5c9dc91e36c6a1">l_SockRaw</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#53aaafbb2179e1b99faa694ab3432403">ul_NbProbes</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rarping_8c.html#86c288a8be1cc8049e9e9b6ca3d7e7a0">ul_ReceivedReplies</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Rarping - send RARP REQUEST to a neighbour host. 
<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd>RFC 903</dd></dl>
<dl class="rcs" compact><dt><b>Author</b></dt><dd>henri.doreau </dd></dl>
<dl class="rcs" compact><dt><b>Date</b></dt><dd>2008-08-07 18:13:27 +0200 (Thu, 07 Aug 2008) </dd></dl>
<p>
<dl class="rcs" compact><dt><b>Revision</b></dt><dd>45 </dd></dl>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="0dc24ff376670e9bec90dc60d7dfdc78"></a><!-- doxytag: member="rarping.c::__MAC" ref="0dc24ff376670e9bec90dc60d7dfdc78" args="(i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __MAC          </td>
          <td>(</td>
          <td class="paramtype">i&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(pstr_reply-&gt;tuc_senderHwAddr[(i)])</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="40075e1591659ba8ec8a37a9fcc4d8b3"></a><!-- doxytag: member="rarping.c::_MAC" ref="40075e1591659ba8ec8a37a9fcc4d8b3" args="(i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _MAC          </td>
          <td>(</td>
          <td class="paramtype">i&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;pstr_reply-&gt;str_packet.tuc_targetHwAddr[(i)]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="370fdec85b226dbc8e3c347051e0a48a"></a><!-- doxytag: member="rarping.c::MAC" ref="370fdec85b226dbc8e3c347051e0a48a" args="(i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAC          </td>
          <td>(</td>
          <td class="paramtype">i&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;pstr_reply-&gt;tuc_senderHwAddr[(i)]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="4f24c79e4a47dd1904b8857ca16264a4"></a><!-- doxytag: member="rarping.c::MAC_FIELD" ref="4f24c79e4a47dd1904b8857ca16264a4" args="(a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAC_FIELD          </td>
          <td>(</td>
          <td class="paramtype">a&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(&amp;(pstr_packet-&gt;str_packet.tuc_targetHwAddr[(a)]))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="3672fcf015b00197c21d3807411f7fca"></a><!-- doxytag: member="rarping.c::OPERATION" ref="3672fcf015b00197c21d3807411f7fca" args="(o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPERATION          </td>
          <td>(</td>
          <td class="paramtype">o&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;( ( o == htons(RARP_OPCODE_REPLY) ) ? &quot;Reply&quot; : &quot;Request&quot; )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="e397cceb6eb270526ed25111b8e4bff3"></a><!-- doxytag: member="rarping.c::argumentManagement" ref="e397cceb6eb270526ed25111b8e4bff3" args="(long l_argc, char **ppch_argv, opt_t *pstr_argsDest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char argumentManagement           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>l_argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>ppch_argv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structopt__t.html">opt_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_argsDest</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Parse given arguments and fill an opt structure. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>l_argc</em>&nbsp;</td><td>is the number of arguments contained in command line when launching the soft </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ppch_argv</em>&nbsp;</td><td>is an array of pointers to the arguments given </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pst_argsDest</em>&nbsp;</td><td>is a structure where are stored user defined options </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Error code according to the execution of the function </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>The function ends normally </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ERR_ARG_PARSING</em>&nbsp;</td><td>(&lt; 0) can't parse command line </td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="structopt__t.html" title="Contains options/informations given trought command line.">opt_t</a> </dd></dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="rarping_8c_e397cceb6eb270526ed25111b8e4bff3_cgraph.png" border="0" usemap="#rarping_8c_e397cceb6eb270526ed25111b8e4bff3_cgraph_map" alt=""></center>
<map name="rarping_8c_e397cceb6eb270526ed25111b8e4bff3_cgraph_map">
<area shape="rect" href="rarping_8c.html#1432cdc2d9d5c8ada6ea3bb523f07f73" title="set options to their default values" alt="" coords="211,5,339,32"><area shape="rect" href="rarping_8c.html#975c3819cf5b8555b0b73653625bc83c" title="set the send/recv timeout from command line to integers" alt="" coords="223,56,327,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="7ed00cf5907b4a33a63d30fcfec8254a"></a><!-- doxytag: member="rarping.c::craftPacket" ref="7ed00cf5907b4a33a63d30fcfec8254a" args="(etherPacket_t *pstr_packet, const opt_t *pstr_destArgs, struct sockaddr_ll *pstr_device, long l_socket)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char craftPacket           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structetherPacket__t.html">etherPacket_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structopt__t.html">opt_t</a> *&nbsp;</td>
          <td class="paramname"> <em>str_destArgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_ll *&nbsp;</td>
          <td class="paramname"> <em>pstr_device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>l_socket</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
find out and packs the datas we'll send 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pstr_packet</em>&nbsp;</td><td>points to a struct this function will fill with raw datas to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pch_ifaceName</em>&nbsp;</td><td>is a string containing the interface to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pstr_device</em>&nbsp;</td><td>points to a structure that will contain low level informations needed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pch_askedHwAddr</em>&nbsp;</td><td>(string) contains the hardware address to request about </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>l_socket</em>&nbsp;</td><td>is the raw socket opened before </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Error code according to the execution of the function </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>the function ends normally </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>bad interface given </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-2</em>&nbsp;</td><td>bad hardware address given, or unrecognized format </td></tr>
  </table>
</dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="rarping_8c_7ed00cf5907b4a33a63d30fcfec8254a_cgraph.png" border="0" usemap="#rarping_8c_7ed00cf5907b4a33a63d30fcfec8254a_cgraph_map" alt=""></center>
<map name="rarping_8c_7ed00cf5907b4a33a63d30fcfec8254a_cgraph_map">
<area shape="rect" href="rarping_8c.html#13c258f47f42f6e9a08dae19c34bce70" title="fills a sockaddr_ll struct whith hardware address and interface index of a selected..." alt="" coords="153,31,279,57"><area shape="rect" href="rarping_8c.html#3023edfca60313cf518681d105a5ba23" title="set source IP address in packets to wanted values" alt="" coords="145,81,287,108"><area shape="rect" href="rarping_8c.html#728f873a92175b64fb21ff9e4d497af4" title="fills target protocol address in sent packets according to user choices (option &#45;a)..." alt="" coords="147,132,285,159"><area shape="rect" href="rarping_8c.html#b184cb462e59b63bec4d7a59f05afea6" title="get Index of used network interface" alt="" coords="375,5,476,32"><area shape="rect" href="rarping_8c.html#9a6902ad34267ecbc0b310fd3ccaa0cb" title="fill hw_addr field of pstr_device with local MAC address" alt="" coords="336,56,515,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="984e5dd95edfe9b2c7f7811d07e4a7cc"></a><!-- doxytag: member="rarping.c::footer" ref="984e5dd95edfe9b2c7f7811d07e4a7cc" args="(unsigned long ul_sentPackets, unsigned long ul_receivedPackets)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char footer           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>ul_sentPackets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>ul_receivedPackets</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
print out a summary of what happened 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ul_sentPackets</em>&nbsp;</td><td>number of sent packets </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ul_receivedPackets</em>&nbsp;</td><td>number of received packets </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Error code according to the execution of the function </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>the function ends normally </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>not any packet were sent </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="ed621b2e2a3ad104bf667e26e80c35ca"></a><!-- doxytag: member="rarping.c::getAnswer" ref="ed621b2e2a3ad104bf667e26e80c35ca" args="(long l_socket, struct sockaddr_ll *pstr_device, const struct timeval str_sendingMoment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char getAnswer           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>l_socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_ll *&nbsp;</td>
          <td class="paramname"> <em>pstr_device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct timeval&nbsp;</td>
          <td class="paramname"> <em>str_sendingMoment</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
wait for an answer and, if receive any, parse it 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>l_socket</em>&nbsp;</td><td>is the raw socket opened before </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pstr_device</em>&nbsp;</td><td>low level informations to receive datas without any encapsulation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>str_sendingMoment</em>&nbsp;</td><td>is used to chronometer and print out how fast the received replies are </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>the number of replies received </dd></dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="rarping_8c_ed621b2e2a3ad104bf667e26e80c35ca_cgraph.png" border="0" usemap="#rarping_8c_ed621b2e2a3ad104bf667e26e80c35ca_cgraph_map" alt=""></center>
<map name="rarping_8c_ed621b2e2a3ad104bf667e26e80c35ca_cgraph_map">
<area shape="rect" href="rarping_8c.html#22be8ae77bc49dfa0a403b60e5186e2b" title="check if received packet seems correct (or not) it and print its main informations..." alt="" coords="139,31,243,57"><area shape="rect" href="rarping_8c.html#8ddba88678a5ae107d94fbe38926221d" title="return elapsed time between two given moments" alt="" coords="156,81,225,108"><area shape="rect" href="rarping_8c.html#8ae63b7cf808d9190afe4bb3a8c2968b" title="parse an reply packet and fill strings to print results out in a clean way" alt="" coords="315,5,371,32"><area shape="rect" href="rarping_8c.html#9f9e5763d159bb3d641265d0030a65c2" title="print out elapsed time from a timeval structure to usual format in milliseconds" alt="" coords="292,56,393,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="b184cb462e59b63bec4d7a59f05afea6"></a><!-- doxytag: member="rarping.c::getIfaceIndex" ref="b184cb462e59b63bec4d7a59f05afea6" args="(char *pch_ifName, long l_socket)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long getIfaceIndex           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pch_ifName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>l_socket</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
get Index of used network interface 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pch_ifName</em>&nbsp;</td><td>(string) contains the name of the selected interface as provided by user </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>l_socket</em>&nbsp;</td><td>raw socket opened befor </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>interface index </dd></dl>

</div>
</div><p>
<a class="anchor" name="9a6902ad34267ecbc0b310fd3ccaa0cb"></a><!-- doxytag: member="rarping.c::getLocalHardwareAddress" ref="9a6902ad34267ecbc0b310fd3ccaa0cb" args="(long l_socket, char *pch_ifaceName, unsigned char *puc_mac)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char getLocalHardwareAddress           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>l_socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pch_ifaceName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>puc_mac</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
fill hw_addr field of pstr_device with local MAC address 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>l_socket</em>&nbsp;</td><td>raw socket opened befor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pch_ifaceName</em>&nbsp;</td><td>(string) contains the name of the selected interface as provided by user </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mac</em>&nbsp;</td><td>string filled with the hardware address of the selected interface </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Error code according to the execution of the function </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>the function ends normally </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>can't find MAC address </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="13c258f47f42f6e9a08dae19c34bce70"></a><!-- doxytag: member="rarping.c::getLowLevelInfos" ref="13c258f47f42f6e9a08dae19c34bce70" args="(struct sockaddr_ll *pstr_device, char *pch_ifaceName, long l_socket)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char getLowLevelInfos           </td>
          <td>(</td>
          <td class="paramtype">struct sockaddr_ll *&nbsp;</td>
          <td class="paramname"> <em>pstr_device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pch_ifaceName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>l_socket</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
fills a sockaddr_ll struct whith hardware address and interface index of a selected device 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pstr_device</em>&nbsp;</td><td>contains provides a low level device independant access </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pch_ifaceName</em>&nbsp;</td><td>(string) contains the hardware address to request about </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>l_socket</em>&nbsp;</td><td>raw socket opened before </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Error code according to the execution of the function </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>the function ends normally </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>if function can't provide low level infos </td></tr>
  </table>
</dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="rarping_8c_13c258f47f42f6e9a08dae19c34bce70_cgraph.png" border="0" usemap="#rarping_8c_13c258f47f42f6e9a08dae19c34bce70_cgraph_map" alt=""></center>
<map name="rarping_8c_13c258f47f42f6e9a08dae19c34bce70_cgraph_map">
<area shape="rect" href="rarping_8c.html#b184cb462e59b63bec4d7a59f05afea6" title="get Index of used network interface" alt="" coords="217,5,319,32"><area shape="rect" href="rarping_8c.html#9a6902ad34267ecbc0b310fd3ccaa0cb" title="fill hw_addr field of pstr_device with local MAC address" alt="" coords="179,56,357,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="1432cdc2d9d5c8ada6ea3bb523f07f73"></a><!-- doxytag: member="rarping.c::initOptionsDefault" ref="1432cdc2d9d5c8ada6ea3bb523f07f73" args="(opt_t *pstr_args)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initOptionsDefault           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopt__t.html">opt_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_args</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
set options to their default values 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pstr_argsDest</em>&nbsp;</td><td>points to the structure where user choices are stored </td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="structopt__t.html" title="Contains options/informations given trought command line.">opt_t</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="56282d3e5a61eb963960b9e342c9209b"></a><!-- doxytag: member="rarping.c::loop" ref="56282d3e5a61eb963960b9e342c9209b" args="(const opt_t *pstr_argsDest, etherPacket_t *pstr_packet, struct sockaddr_ll *pstr_device, long l_socket)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char loop           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structopt__t.html">opt_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_argsDest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structetherPacket__t.html">etherPacket_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_ll *&nbsp;</td>
          <td class="paramname"> <em>pstr_device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>l_socket</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
sending loop : send packets as many times as wanted 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pstr_argsDest</em>&nbsp;</td><td>points to the structure which contains user inputs </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pstr_packet</em>&nbsp;</td><td>points to the packet to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sockaddr_ll</em>&nbsp;</td><td>low level information to send datas without encapsulation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>l_socket</em>&nbsp;</td><td>Raw socket opened before </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Error code according to the execution of the function </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>the function ends normally </td></tr>
  </table>
</dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="rarping_8c_56282d3e5a61eb963960b9e342c9209b_cgraph.png" border="0" usemap="#rarping_8c_56282d3e5a61eb963960b9e342c9209b_cgraph_map" alt=""></center>
<map name="rarping_8c_56282d3e5a61eb963960b9e342c9209b_cgraph_map">
<area shape="rect" href="rarping_8c.html#ed621b2e2a3ad104bf667e26e80c35ca" title="wait for an answer and, if receive any, parse it" alt="" coords="103,56,188,83"><area shape="rect" href="rarping_8c.html#4d844224c84eb2a75608f8840a5d72be" title="send RARP requests into the wild" alt="" coords="103,107,188,133"><area shape="rect" href="rarping_8c.html#22be8ae77bc49dfa0a403b60e5186e2b" title="check if received packet seems correct (or not) it and print its main informations..." alt="" coords="237,31,341,57"><area shape="rect" href="rarping_8c.html#8ddba88678a5ae107d94fbe38926221d" title="return elapsed time between two given moments" alt="" coords="255,81,324,108"><area shape="rect" href="rarping_8c.html#8ae63b7cf808d9190afe4bb3a8c2968b" title="parse an reply packet and fill strings to print results out in a clean way" alt="" coords="413,5,469,32"><area shape="rect" href="rarping_8c.html#9f9e5763d159bb3d641265d0030a65c2" title="print out elapsed time from a timeval structure to usual format in milliseconds" alt="" coords="391,56,492,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="c1fc16855ffe58bf476aad4da287655a"></a><!-- doxytag: member="rarping.c::main" ref="c1fc16855ffe58bf476aad4da287655a" args="(int i_argc, char **ppch_argv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i_argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>ppch_argv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="rarping_8c_c1fc16855ffe58bf476aad4da287655a_cgraph.png" border="0" usemap="#rarping_8c_c1fc16855ffe58bf476aad4da287655a_cgraph_map" alt=""></center>
<map name="rarping_8c_c1fc16855ffe58bf476aad4da287655a_cgraph_map">
<area shape="rect" href="rarping_8c.html#e397cceb6eb270526ed25111b8e4bff3" title="Parse given arguments and fill an opt structure." alt="" coords="105,56,260,83"><area shape="rect" href="rarping_8c.html#06ebd348792c0bc8027a46188dd634b5" title="perform RARP requests the way defined by user" alt="" coords="121,196,244,223"><area shape="rect" href="rarping_8c.html#2497a004acee842423e413bd0f7c52a4" title="turn on the signal handler" alt="" coords="132,132,233,159"><area shape="rect" href="rarping_8c.html#e8605e2b78cd4a81b6c6b5c30cb7366a" title="Usage() prints out some help to craft a correct command line." alt="" coords="153,247,212,273"><area shape="rect" href="rarping_8c.html#1432cdc2d9d5c8ada6ea3bb523f07f73" title="set options to their default values" alt="" coords="309,5,437,32"><area shape="rect" href="rarping_8c.html#975c3819cf5b8555b0b73653625bc83c" title="set the send/recv timeout from command line to integers" alt="" coords="321,56,425,83"><area shape="rect" href="rarping_8c.html#7ed00cf5907b4a33a63d30fcfec8254a" title="find out and packs the datas we&#39;ll send" alt="" coords="329,335,417,361"><area shape="rect" href="rarping_8c.html#984e5dd95edfe9b2c7f7811d07e4a7cc" title="print out a summary of what happened" alt="" coords="529,132,585,159"><area shape="rect" href="rarping_8c.html#56282d3e5a61eb963960b9e342c9209b" title="sending loop : send packets as many times as wanted" alt="" coords="351,259,396,285"><area shape="rect" href="rarping_8c.html#bf75ee27a5591a9c04cb8720abbf4518" title="open a raw socket and set timeout on sending and reception" alt="" coords="315,157,432,184"><area shape="rect" href="rarping_8c.html#13c258f47f42f6e9a08dae19c34bce70" title="fills a sockaddr_ll struct whith hardware address and interface index of a selected..." alt="" coords="495,309,620,336"><area shape="rect" href="rarping_8c.html#3023edfca60313cf518681d105a5ba23" title="set source IP address in packets to wanted values" alt="" coords="487,360,628,387"><area shape="rect" href="rarping_8c.html#728f873a92175b64fb21ff9e4d497af4" title="fills target protocol address in sent packets according to user choices (option &#45;a)..." alt="" coords="488,411,627,437"><area shape="rect" href="rarping_8c.html#b184cb462e59b63bec4d7a59f05afea6" title="get Index of used network interface" alt="" coords="716,309,817,336"><area shape="rect" href="rarping_8c.html#9a6902ad34267ecbc0b310fd3ccaa0cb" title="fill hw_addr field of pstr_device with local MAC address" alt="" coords="677,360,856,387"><area shape="rect" href="rarping_8c.html#ed621b2e2a3ad104bf667e26e80c35ca" title="wait for an answer and, if receive any, parse it" alt="" coords="515,259,600,285"><area shape="rect" href="rarping_8c.html#4d844224c84eb2a75608f8840a5d72be" title="send RARP requests into the wild" alt="" coords="515,208,600,235"><area shape="rect" href="rarping_8c.html#22be8ae77bc49dfa0a403b60e5186e2b" title="check if received packet seems correct (or not) it and print its main informations..." alt="" coords="715,208,819,235"><area shape="rect" href="rarping_8c.html#8ddba88678a5ae107d94fbe38926221d" title="return elapsed time between two given moments" alt="" coords="732,259,801,285"><area shape="rect" href="rarping_8c.html#8ae63b7cf808d9190afe4bb3a8c2968b" title="parse an reply packet and fill strings to print results out in a clean way" alt="" coords="928,183,984,209"><area shape="rect" href="rarping_8c.html#9f9e5763d159bb3d641265d0030a65c2" title="print out elapsed time from a timeval structure to usual format in milliseconds" alt="" coords="905,233,1007,260"><area shape="rect" href="rarping_8c.html#abfe4c4e5d4579ed37318039e6b20678" title="perform a clean exit, calling statistics function and closing the socket" alt="" coords="321,107,425,133"></map>
</div>

</div>
</div><p>
<a class="anchor" name="bf75ee27a5591a9c04cb8720abbf4518"></a><!-- doxytag: member="rarping.c::openRawSocket" ref="bf75ee27a5591a9c04cb8720abbf4518" args="(struct timeval str_timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed long openRawSocket           </td>
          <td>(</td>
          <td class="paramtype">struct timeval&nbsp;</td>
          <td class="paramname"> <em>str_timeout</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
open a raw socket and set timeout on sending and reception 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>none</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>return code of socket() : &gt; is the socket we want, &lt; 0 if an error ocured </dd></dl>

</div>
</div><p>
<a class="anchor" name="8ae63b7cf808d9190afe4bb3a8c2968b"></a><!-- doxytag: member="rarping.c::parse" ref="8ae63b7cf808d9190afe4bb3a8c2968b" args="(etherPacket_t *pstr_reply, char tch_replySrcIp[], char tch_replySrcHwAddr[], char tch_replyHwAddr[], char tch_replyAddrIp[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char parse           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structetherPacket__t.html">etherPacket_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_reply</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>tch_replySrcIp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>tch_replySrcHwAddr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>tch_replyHwAddr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>tch_replyAddrIp</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
parse an reply packet and fill strings to print results out in a clean way 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pstr_reply</em>&nbsp;</td><td>datas to parse (received packet) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tch_replySrcIp</em>&nbsp;</td><td>formatted string containing IP address of the sender of the reply </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tch_replySrcHwAddr</em>&nbsp;</td><td>formatted string containing MAC address of the sender of the reply </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tch_replyHwAddr</em>&nbsp;</td><td>formatted string containing MAC address we were requesting </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tch_replyAddrIp</em>&nbsp;</td><td>formatted string containing IP address we were asking for </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Error code according to the execution of the function </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>the function ends normally </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="975c3819cf5b8555b0b73653625bc83c"></a><!-- doxytag: member="rarping.c::parseTimeout" ref="975c3819cf5b8555b0b73653625bc83c" args="(struct timeval *pstr_timeout, char *pch_arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseTimeout           </td>
          <td>(</td>
          <td class="paramtype">struct timeval *&nbsp;</td>
          <td class="paramname"> <em>pstr_timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pch_arg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
set the send/recv timeout from command line to integers 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pstr_timeout</em>&nbsp;</td><td>vdestination of parsed argument </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pch_arg</em>&nbsp;</td><td>timeout, as string, given by user through command line </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>none </dd></dl>

</div>
</div><p>
<a class="anchor" name="06ebd348792c0bc8027a46188dd634b5"></a><!-- doxytag: member="rarping.c::performRequests" ref="06ebd348792c0bc8027a46188dd634b5" args="(const opt_t *pstr_argsDest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char performRequests           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structopt__t.html">opt_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_argsDest</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
perform RARP requests the way defined by user 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pst_argsDest</em>&nbsp;</td><td>is an <a class="el" href="structopt__t.html" title="Contains options/informations given trought command line.">opt_t</a> structure which contains user defined options </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Error code according to the execution of the function </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>The function ends normally </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>can't open RAW socket </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-3</em>&nbsp;</td><td>can't craft packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-4</em>&nbsp;</td><td>error when closing socket </td></tr>
  </table>
</dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="rarping_8c_06ebd348792c0bc8027a46188dd634b5_cgraph.png" border="0" usemap="#rarping_8c_06ebd348792c0bc8027a46188dd634b5_cgraph_map" alt=""></center>
<map name="rarping_8c_06ebd348792c0bc8027a46188dd634b5_cgraph_map">
<area shape="rect" href="rarping_8c.html#7ed00cf5907b4a33a63d30fcfec8254a" title="find out and packs the datas we&#39;ll send" alt="" coords="195,81,283,108"><area shape="rect" href="rarping_8c.html#984e5dd95edfe9b2c7f7811d07e4a7cc" title="print out a summary of what happened" alt="" coords="211,132,267,159"><area shape="rect" href="rarping_8c.html#56282d3e5a61eb963960b9e342c9209b" title="sending loop : send packets as many times as wanted" alt="" coords="216,183,261,209"><area shape="rect" href="rarping_8c.html#bf75ee27a5591a9c04cb8720abbf4518" title="open a raw socket and set timeout on sending and reception" alt="" coords="180,233,297,260"><area shape="rect" href="rarping_8c.html#13c258f47f42f6e9a08dae19c34bce70" title="fills a sockaddr_ll struct whith hardware address and interface index of a selected..." alt="" coords="356,31,481,57"><area shape="rect" href="rarping_8c.html#3023edfca60313cf518681d105a5ba23" title="set source IP address in packets to wanted values" alt="" coords="348,81,489,108"><area shape="rect" href="rarping_8c.html#728f873a92175b64fb21ff9e4d497af4" title="fills target protocol address in sent packets according to user choices (option &#45;a)..." alt="" coords="349,132,488,159"><area shape="rect" href="rarping_8c.html#b184cb462e59b63bec4d7a59f05afea6" title="get Index of used network interface" alt="" coords="577,5,679,32"><area shape="rect" href="rarping_8c.html#9a6902ad34267ecbc0b310fd3ccaa0cb" title="fill hw_addr field of pstr_device with local MAC address" alt="" coords="539,56,717,83"><area shape="rect" href="rarping_8c.html#ed621b2e2a3ad104bf667e26e80c35ca" title="wait for an answer and, if receive any, parse it" alt="" coords="376,183,461,209"><area shape="rect" href="rarping_8c.html#4d844224c84eb2a75608f8840a5d72be" title="send RARP requests into the wild" alt="" coords="376,233,461,260"><area shape="rect" href="rarping_8c.html#22be8ae77bc49dfa0a403b60e5186e2b" title="check if received packet seems correct (or not) it and print its main informations..." alt="" coords="576,157,680,184"><area shape="rect" href="rarping_8c.html#8ddba88678a5ae107d94fbe38926221d" title="return elapsed time between two given moments" alt="" coords="593,208,663,235"><area shape="rect" href="rarping_8c.html#8ae63b7cf808d9190afe4bb3a8c2968b" title="parse an reply packet and fill strings to print results out in a clean way" alt="" coords="789,132,845,159"><area shape="rect" href="rarping_8c.html#9f9e5763d159bb3d641265d0030a65c2" title="print out elapsed time from a timeval structure to usual format in milliseconds" alt="" coords="767,183,868,209"></map>
</div>

</div>
</div><p>
<a class="anchor" name="22be8ae77bc49dfa0a403b60e5186e2b"></a><!-- doxytag: member="rarping.c::printOutReply" ref="22be8ae77bc49dfa0a403b60e5186e2b" args="(etherPacket_t *pstr_reply, const struct timeval str_delay)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printOutReply           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structetherPacket__t.html">etherPacket_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_reply</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct timeval&nbsp;</td>
          <td class="paramname"> <em>str_delay</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
check if received packet seems correct (or not) it and print its main informations 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pstr_reply</em>&nbsp;</td><td>points to the received packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>str_delay</em>&nbsp;</td><td>is the time elapsed between sending and reeption </td></tr>
  </table>
</dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="rarping_8c_22be8ae77bc49dfa0a403b60e5186e2b_cgraph.png" border="0" usemap="#rarping_8c_22be8ae77bc49dfa0a403b60e5186e2b_cgraph_map" alt=""></center>
<map name="rarping_8c_22be8ae77bc49dfa0a403b60e5186e2b_cgraph_map">
<area shape="rect" href="rarping_8c.html#8ae63b7cf808d9190afe4bb3a8c2968b" title="parse an reply packet and fill strings to print results out in a clean way" alt="" coords="181,5,237,32"><area shape="rect" href="rarping_8c.html#9f9e5763d159bb3d641265d0030a65c2" title="print out elapsed time from a timeval structure to usual format in milliseconds" alt="" coords="159,56,260,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="9f9e5763d159bb3d641265d0030a65c2"></a><!-- doxytag: member="rarping.c::printTime_ms" ref="9f9e5763d159bb3d641265d0030a65c2" args="(const struct timeval str_time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printTime_ms           </td>
          <td>(</td>
          <td class="paramtype">const struct timeval&nbsp;</td>
          <td class="paramname"> <em>str_time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
print out elapsed time from a timeval structure to usual format in milliseconds 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>str_time</em>&nbsp;</td><td>contains a number of seconds and microseconds </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="abfe4c4e5d4579ed37318039e6b20678"></a><!-- doxytag: member="rarping.c::rarpingOnExit" ref="abfe4c4e5d4579ed37318039e6b20678" args="(int sig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rarpingOnExit           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sig</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
perform a clean exit, calling statistics function and closing the socket 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>sig received signal that force rarping to exit </td></tr>
  </table>
</dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="rarping_8c_abfe4c4e5d4579ed37318039e6b20678_cgraph.png" border="0" usemap="#rarping_8c_abfe4c4e5d4579ed37318039e6b20678_cgraph_map" alt=""></center>
<map name="rarping_8c_abfe4c4e5d4579ed37318039e6b20678_cgraph_map">
<area shape="rect" href="rarping_8c.html#984e5dd95edfe9b2c7f7811d07e4a7cc" title="print out a summary of what happened" alt="" coords="159,5,215,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="4d844224c84eb2a75608f8840a5d72be"></a><!-- doxytag: member="rarping.c::sendProbe" ref="4d844224c84eb2a75608f8840a5d72be" args="(long l_socket, etherPacket_t *pstr_packet, struct sockaddr_ll *pstr_device)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char sendProbe           </td>
          <td>(</td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>l_socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structetherPacket__t.html">etherPacket_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_ll *&nbsp;</td>
          <td class="paramname"> <em>pstr_device</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
send RARP requests into the wild 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>l_socket</em>&nbsp;</td><td>raw socket opened before </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pstr_packet</em>&nbsp;</td><td>raw datas to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pstr_device</em>&nbsp;</td><td>low level informations to send datas without any encapsulation </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Error code according to the execution of the function </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>the function ends normally </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>-1 can't perform sending </dd></dl>

</div>
</div><p>
<a class="anchor" name="3023edfca60313cf518681d105a5ba23"></a><!-- doxytag: member="rarping.c::setSenderIpAddress" ref="3023edfca60313cf518681d105a5ba23" args="(unsigned char *puc_senderIpAddress, const opt_t *pstr_argsDest, long l_socket)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char setSenderIpAddress           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>puc_senderIpAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structopt__t.html">opt_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_argsDest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&nbsp;</td>
          <td class="paramname"> <em>l_socket</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
set source IP address in packets to wanted values 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>puc_senderIpAddress</em>&nbsp;</td><td>field to fill </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pstr_argsDest</em>&nbsp;</td><td>user options </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>l_socket</em>&nbsp;</td><td>socket descriptor to perform ioctl calls (to find ut local real IP address) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>error</em>&nbsp;</td><td>code according to the execution of the function </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 the function ends normally <p>
1 an error occured : IP address set to its default value : 0.0.0.0 </dd></dl>

</div>
</div><p>
<a class="anchor" name="728f873a92175b64fb21ff9e4d497af4"></a><!-- doxytag: member="rarping.c::setTargetIpAddress" ref="728f873a92175b64fb21ff9e4d497af4" args="(unsigned char *puc_targetIpAddress, const opt_t *pstr_argsDest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed char setTargetIpAddress           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>puc_targetIpAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structopt__t.html">opt_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pstr_argsDest</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
fills target protocol address in sent packets according to user choices (option -a) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>puc_targetIpAddress</em>&nbsp;</td><td>target protocol address field in crafted packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pstr_argsDest</em>&nbsp;</td><td>choosen user's inputs </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Error code according to the execution of the function </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>the function ends normally </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="2497a004acee842423e413bd0f7c52a4"></a><!-- doxytag: member="rarping.c::signalHandler" ref="2497a004acee842423e413bd0f7c52a4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void signalHandler           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
turn on the signal handler 
<p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="rarping_8c_2497a004acee842423e413bd0f7c52a4_cgraph.png" border="0" usemap="#rarping_8c_2497a004acee842423e413bd0f7c52a4_cgraph_map" alt=""></center>
<map name="rarping_8c_2497a004acee842423e413bd0f7c52a4_cgraph_map">
<area shape="rect" href="rarping_8c.html#abfe4c4e5d4579ed37318039e6b20678" title="perform a clean exit, calling statistics function and closing the socket" alt="" coords="157,5,261,32"><area shape="rect" href="rarping_8c.html#984e5dd95edfe9b2c7f7811d07e4a7cc" title="print out a summary of what happened" alt="" coords="311,5,367,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="8ddba88678a5ae107d94fbe38926221d"></a><!-- doxytag: member="rarping.c::timeDiff" ref="8ddba88678a5ae107d94fbe38926221d" args="(const struct timeval str_beginning, const struct timeval str_termination)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct timeval timeDiff           </td>
          <td>(</td>
          <td class="paramtype">const struct timeval&nbsp;</td>
          <td class="paramname"> <em>str_beginning</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct timeval&nbsp;</td>
          <td class="paramname"> <em>str_termination</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
return elapsed time between two given moments 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>str_beginning</em>&nbsp;</td><td>starting point </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>str_termination</em>&nbsp;</td><td>ending point </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>struct timeval containing elapsed time from str_beginning to str_termination </dd></dl>

</div>
</div><p>
<a class="anchor" name="e8605e2b78cd4a81b6c6b5c30cb7366a"></a><!-- doxytag: member="rarping.c::usage" ref="e8605e2b78cd4a81b6c6b5c30cb7366a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void usage           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Usage() prints out some help to craft a correct command line. 
<p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="ab6d37ae989eb0b6cd5c9dc91e36c6a1"></a><!-- doxytag: member="rarping.c::l_SockRaw" ref="ab6d37ae989eb0b6cd5c9dc91e36c6a1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long <a class="el" href="rarping_8c.html#ab6d37ae989eb0b6cd5c9dc91e36c6a1">l_SockRaw</a> = 0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="53aaafbb2179e1b99faa694ab3432403"></a><!-- doxytag: member="rarping.c::ul_NbProbes" ref="53aaafbb2179e1b99faa694ab3432403" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long <a class="el" href="rarping_8c.html#53aaafbb2179e1b99faa694ab3432403">ul_NbProbes</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="86c288a8be1cc8049e9e9b6ca3d7e7a0"></a><!-- doxytag: member="rarping.c::ul_ReceivedReplies" ref="86c288a8be1cc8049e9e9b6ca3d7e7a0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long <a class="el" href="rarping_8c.html#86c288a8be1cc8049e9e9b6ca3d7e7a0">ul_ReceivedReplies</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Sep 2 15:22:29 2008 for RARPing by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
